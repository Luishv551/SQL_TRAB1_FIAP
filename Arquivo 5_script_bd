-- Generated by Oracle SQL Developer Data Modeler 22.2.0.165.1149
--   at:        2023-03-20 21:34:38 PDT
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g


/*
DROP TABLE t_sgv_categoria_produto CASCADE CONSTRAINTS;

DROP TABLE t_sgv_chamado CASCADE CONSTRAINTS;

DROP TABLE t_sgv_cidade CASCADE CONSTRAINTS;

DROP TABLE t_sgv_cliente CASCADE CONSTRAINTS;

DROP TABLE t_sgv_departamento CASCADE CONSTRAINTS;

DROP TABLE t_sgv_estado CASCADE CONSTRAINTS;

DROP TABLE t_sgv_funcionario CASCADE CONSTRAINTS;

DROP TABLE t_sgv_inf_acesso CASCADE CONSTRAINTS;

DROP TABLE t_sgv_nivel_beneficio CASCADE CONSTRAINTS;

DROP TABLE t_sgv_pessoa_fisica CASCADE CONSTRAINTS;

DROP TABLE t_sgv_pessoa_juridica CASCADE CONSTRAINTS;

DROP TABLE t_sgv_produto CASCADE CONSTRAINTS;

DROP TABLE t_sgv_status_chamado CASCADE CONSTRAINTS;

DROP TABLE t_sgv_tipo_video CASCADE CONSTRAINTS;

DROP TABLE t_sgv_video_produto CASCADE CONSTRAINTS;

DROP TABLE t_sgv_visualização_video CASCADE CONSTRAINTS;
*/

-- predefined type, no DDL - MDSYS.SDO_GEOMETRY

-- predefined type, no DDL - XMLTYPE

CREATE TABLE t_sgv_categoria_produto (
    cod_categoria NUMBER(5) NOT NULL,
    des_categoria VARCHAR2(50) NOT NULL,
    status        VARCHAR2(30) NOT NULL,
    dat_inicio    DATE NOT NULL,
    dat_termino   DATE
);

COMMENT ON TABLE t_sgv_categoria_produto IS
    'Entidade que armazena as categorias dos produtos';

COMMENT ON COLUMN t_sgv_categoria_produto.cod_categoria IS
    'Atributo identificador da entidade categoria do produto';

COMMENT ON COLUMN t_sgv_categoria_produto.des_categoria IS
    'Atributo que armazena a descrição da categoria do produto';

COMMENT ON COLUMN t_sgv_categoria_produto.status IS
    'Atributo que armazena o status da categoria do produto';

COMMENT ON COLUMN t_sgv_categoria_produto.dat_inicio IS
    'Atributo que armazena a data de início da categoria do produto';

COMMENT ON COLUMN t_sgv_categoria_produto.dat_termino IS
    'Atributo que armazena a data de encerramento da categoria do produto';

ALTER TABLE t_sgv_categoria_produto ADD CONSTRAINT ck_t_sgv_categoria_produto_1 CHECK ( dat_termino > dat_inicio );

ALTER TABLE t_sgv_categoria_produto ADD CONSTRAINT pk_t_sgv_categoria_produto PRIMARY KEY ( cod_categoria );

ALTER TABLE t_sgv_categoria_produto ADD CONSTRAINT un_t_sgv_categoria_produto UNIQUE ( des_categoria );

CREATE TABLE t_sgv_chamado (
    cod_chamado            NUMBER(10) NOT NULL,
    cod_acesso             NUMBER(10) NOT NULL,
    cod_funcionario        NUMBER(5) NOT NULL,
    cod_status_chamado     NUMBER(2) NOT NULL,
    cod_produto            NUMBER(5) NOT NULL,
    tipo_chamado           VARCHAR2(40) NOT NULL,
    dat_abertura           TIMESTAMP NOT NULL,
    des_cliente_chamado    VARCHAR2(1000) NOT NULL,
    dat_inicio_atendimento TIMESTAMP,
    data_fim_atendimento   TIMESTAMP,
    data_total_atendimento TIMESTAMP,
    indice_satisfacao      NUMBER(2)
);

COMMENT ON TABLE t_sgv_chamado IS
    'Entidade que armazena as informações dos chamados';

COMMENT ON COLUMN t_sgv_chamado.cod_chamado IS
    'Atributo identificador da entidade chamado';

COMMENT ON COLUMN t_sgv_chamado.cod_acesso IS
    'Atributo estrangeiro que armazena em qual acesso o cliente abriu o chamado';

COMMENT ON COLUMN t_sgv_chamado.cod_funcionario IS
    'Atributo estrangeiro que armazena o código do funcionário responsável pelo chamado';

COMMENT ON COLUMN t_sgv_chamado.cod_status_chamado IS
    'Atributo estrangeiro que armazena o status do chamado';

COMMENT ON COLUMN t_sgv_chamado.cod_produto IS
    'Atributo estrangeiro que armazena o código do produto';

COMMENT ON COLUMN t_sgv_chamado.tipo_chamado IS
    'Atributo que armazena o tipo do chamado';

COMMENT ON COLUMN t_sgv_chamado.dat_abertura IS
    'Atributo que armazena a data de abertura do chamado';

COMMENT ON COLUMN t_sgv_chamado.des_cliente_chamado IS
    'Atributo que armazena a descrição deixada pelo cliente sobre o chamado';

COMMENT ON COLUMN t_sgv_chamado.dat_inicio_atendimento IS
    'Atributo que armazena a data de inicio do atendimento';

COMMENT ON COLUMN t_sgv_chamado.data_fim_atendimento IS
    'Atributo que armazena a data de encerramento do atendimento';

COMMENT ON COLUMN t_sgv_chamado.data_total_atendimento IS
    'Atributo que armazena o tempo do atendimento';

COMMENT ON COLUMN t_sgv_chamado.indice_satisfacao IS
    'Atributo que armazena a avaliação do atendimento';

ALTER TABLE t_sgv_chamado
    ADD CONSTRAINT ck_t_sgv_chamado_1 CHECK ( tipo_chamado = 'Duvida'
                                              OR tipo_chamado = 'Sugestao' );

ALTER TABLE t_sgv_chamado
    ADD CONSTRAINT ck_t_sgv_chamado_2 CHECK ( indice_satisfacao IS NOT NULL
                                              OR data_fim_atendimento IS NULL );

ALTER TABLE t_sgv_chamado ADD CONSTRAINT pk_t_sgv_chamado PRIMARY KEY ( cod_chamado );

CREATE TABLE t_sgv_cidade (
    cod_cidade NUMBER(5) NOT NULL,
    cod_estado NUMBER(5) NOT NULL,
    nom_cidade VARCHAR2(50) NOT NULL
);

COMMENT ON TABLE t_sgv_cidade IS
    'Entidade que armazena as informações sobre cada cidade';

COMMENT ON COLUMN t_sgv_cidade.cod_cidade IS
    'Atributo identificador da entidade cidade';

COMMENT ON COLUMN t_sgv_cidade.cod_estado IS
    'Atributo identificador estrangeiro que armazena o código do estado';

COMMENT ON COLUMN t_sgv_cidade.nom_cidade IS
    'Atributo que armazena o nome da cidade';

ALTER TABLE t_sgv_cidade ADD CONSTRAINT pk_t_sgv_cidade PRIMARY KEY ( cod_cidade,
                                                                      cod_estado );

CREATE TABLE t_sgv_cliente (
    cod_cliente                   NUMBER(5) NOT NULL,
    cod_nivel                     NUMBER(5) NOT NULL,
    cod_cidade                    NUMBER(5) NOT NULL,
    num_endereco                  NUMBER(5) NOT NULL,
    tipo_logradouro               VARCHAR2(50) NOT NULL,
    complemento_endereco          VARCHAR2(70),
    nom_cliente                   VARCHAR2(100) NOT NULL,
    nom_logradouro                VARCHAR2(100) NOT NULL,
    classificacao_estrela_cliente NUMBER(1) NOT NULL,
    status_cliente                CHAR(1) NOT NULL,
    login_cliente                 VARCHAR2(50) NOT NULL,
    senha_cliente                 VARCHAR2(50) NOT NULL,
    ddd_telefone_cliente          NUMBER(3),
    sufixo_telefone_cliente       NUMBER(4),
    prefixo_telefone_cliente      NUMBER(5),
    cod_estado                    NUMBER(5) NOT NULL,
    tipo_cliente                  CHAR(1) NOT NULL
);

COMMENT ON TABLE t_sgv_cliente IS
    'Entidade genérica que armazena as informações sobre cada cliente';

COMMENT ON COLUMN t_sgv_cliente.cod_cliente IS
    'Atributo identificador da entidade cliente';

COMMENT ON COLUMN t_sgv_cliente.cod_nivel IS
    'Atributo estrangeiro que armazena o nível do cliente';

COMMENT ON COLUMN t_sgv_cliente.cod_cidade IS
    'Atributo estrangeiro que armazena a cidade do cliente';

COMMENT ON COLUMN t_sgv_cliente.num_endereco IS
    'Atributo que armazena o numero do endereço do cliente';

COMMENT ON COLUMN t_sgv_cliente.tipo_logradouro IS
    'Atributo que armazena o tipo de logradouro do cliente';

COMMENT ON COLUMN t_sgv_cliente.complemento_endereco IS
    'Atributo que armazena o complemento do endereço do cliente';

COMMENT ON COLUMN t_sgv_cliente.nom_cliente IS
    'Atributo que armazena o nome do cliente';

COMMENT ON COLUMN t_sgv_cliente.nom_logradouro IS
    'Atributo que armazena o nome do logradouro';

COMMENT ON COLUMN t_sgv_cliente.classificacao_estrela_cliente IS
    'Atributo que armazena a classificação do cliente';

COMMENT ON COLUMN t_sgv_cliente.status_cliente IS
    'Atributo que armazena o status do cliente';

COMMENT ON COLUMN t_sgv_cliente.login_cliente IS
    'Atributo que armazena o login do cliente';

COMMENT ON COLUMN t_sgv_cliente.senha_cliente IS
    'Atributo que armazena a senha do cliente';

COMMENT ON COLUMN t_sgv_cliente.ddd_telefone_cliente IS
    'Atributo que armazena o ddd do telefone do cliente';

COMMENT ON COLUMN t_sgv_cliente.sufixo_telefone_cliente IS
    'Atributo que armazena o sufixo do telefone do cliente';

COMMENT ON COLUMN t_sgv_cliente.prefixo_telefone_cliente IS
    'Atributo que armazena o prefixo do telefone do cliente';

COMMENT ON COLUMN t_sgv_cliente.tipo_cliente IS
    'Coluna discriminadora';

ALTER TABLE t_sgv_cliente ADD CONSTRAINT ck_t_sgv_cliente_1 CHECK ( classificacao_estrela_cliente <= 5 );

ALTER TABLE t_sgv_cliente
    ADD CONSTRAINT ck_t_sgv_cliente_2 CHECK ( status_cliente = 'A'
                                              OR status_cliente = 'I' );

ALTER TABLE t_sgv_cliente ADD CONSTRAINT pk_t_sgv_cliente PRIMARY KEY ( cod_cliente );

CREATE TABLE t_sgv_departamento (
    cod_departamento   NUMBER(5) NOT NULL,
    sigla_departamento CHAR(3) NOT NULL,
    des_departamento   VARCHAR2(50) NOT NULL
);

COMMENT ON TABLE t_sgv_departamento IS
    'Entidade que armazena os dados dos departamentos dos funcionários';

COMMENT ON COLUMN t_sgv_departamento.cod_departamento IS
    'Atributo identificador da entidade departamento';

COMMENT ON COLUMN t_sgv_departamento.sigla_departamento IS
    'Atributo que armazena a sigla do departamento';

COMMENT ON COLUMN t_sgv_departamento.des_departamento IS
    'Atributo que armazena a descrição do departamento';

ALTER TABLE t_sgv_departamento ADD CONSTRAINT pk_t_sgv_departamento PRIMARY KEY ( cod_departamento );

CREATE TABLE t_sgv_estado (
    cod_estado   NUMBER(5) NOT NULL,
    nom_estado   VARCHAR2(50) NOT NULL,
    sigla_estado CHAR(2) NOT NULL
);

COMMENT ON TABLE t_sgv_estado IS
    'Entidade que armazena as informações sobre cada estado';

COMMENT ON COLUMN t_sgv_estado.cod_estado IS
    'Atributo identificador da tabela estado';

COMMENT ON COLUMN t_sgv_estado.nom_estado IS
    'Atributo que armazena o nome do estado';

COMMENT ON COLUMN t_sgv_estado.sigla_estado IS
    'Atributo que armazena a sigla do estado';

ALTER TABLE t_sgv_estado ADD CONSTRAINT pk_t_sgv_estado PRIMARY KEY ( cod_estado );

CREATE TABLE t_sgv_funcionario (
    cod_funcionario              NUMBER(5) NOT NULL,
    cod_departamento             NUMBER(5) NOT NULL,
    nom_funcionario              VARCHAR2(100) NOT NULL,
    dat_nascimento               DATE NOT NULL,
    cpf_funcionario              NUMBER(11) NOT NULL,
    ddd_telefone_funcionario     NUMBER(3) NOT NULL,
    sufixo_telefone_funcionario  NUMBER(4) NOT NULL,
    prefixo_telefone_funcionario NUMBER(5) NOT NULL,
    "e-mail"                     VARCHAR2(100) NOT NULL,
    cargo                        VARCHAR2(50) NOT NULL
);

COMMENT ON TABLE t_sgv_funcionario IS
    'Entidade que armazena os dados dos funcionários';

COMMENT ON COLUMN t_sgv_funcionario.cod_funcionario IS
    'Atributo identificador da entidade funcionário';

COMMENT ON COLUMN t_sgv_funcionario.cod_departamento IS
    'Atributo estrangeiro que armazena o código do departamento de cada funcionário';

COMMENT ON COLUMN t_sgv_funcionario.nom_funcionario IS
    'Atributo que armazena o nome do funcionário';

COMMENT ON COLUMN t_sgv_funcionario.dat_nascimento IS
    'Atributo que armazena a data de nascimento do funcionário';

COMMENT ON COLUMN t_sgv_funcionario.cpf_funcionario IS
    'Atributo que armazena o CPF do funcionário';

COMMENT ON COLUMN t_sgv_funcionario.ddd_telefone_funcionario IS
    'Atributo que armazena o ddd do telefone do funcionário';

COMMENT ON COLUMN t_sgv_funcionario.sufixo_telefone_funcionario IS
    'Atributo que armazena o sufixo do telefone do funcionário';

COMMENT ON COLUMN t_sgv_funcionario.prefixo_telefone_funcionario IS
    'Atributo que armazena o prefixo do telefone do funcionário';

COMMENT ON COLUMN t_sgv_funcionario."e-mail" IS
    'Atributo que armazena o e-mail do funcionário';

COMMENT ON COLUMN t_sgv_funcionario.cargo IS
    'Atributo que armazena o cargol do funcionário';

ALTER TABLE t_sgv_funcionario ADD CONSTRAINT pk_t_sgv_funcionario PRIMARY KEY ( cod_funcionario );

CREATE TABLE t_sgv_inf_acesso (
    cod_acesso  NUMBER(10) NOT NULL,
    cod_cliente NUMBER(5) NOT NULL,
    dat_inicio  TIMESTAMP NOT NULL,
    dat_fim     TIMESTAMP
);

COMMENT ON TABLE t_sgv_inf_acesso IS
    'Entidade que armazena as informações do acesso de cada cliente';

COMMENT ON COLUMN t_sgv_inf_acesso.cod_acesso IS
    'Atributo identificador da entidade acesso';

COMMENT ON COLUMN t_sgv_inf_acesso.cod_cliente IS
    'Atributo estrangeiro que armazena o código do cliente';

COMMENT ON COLUMN t_sgv_inf_acesso.dat_inicio IS
    'Atributo que armazena a data do login do cliente';

COMMENT ON COLUMN t_sgv_inf_acesso.dat_fim IS
    'Atributo que armazena a data do logout do cliente';

ALTER TABLE t_sgv_inf_acesso ADD CONSTRAINT pk_t_sgv_inf_acesso PRIMARY KEY ( cod_acesso );

CREATE TABLE t_sgv_nivel_beneficio (
    cod_nivel                     NUMBER(5) NOT NULL,
    desconto                      NUMBER(4, 2) NOT NULL,
    classificacao_estrela_cliente NUMBER(1) NOT NULL
);

COMMENT ON TABLE t_sgv_nivel_beneficio IS
    'Entidade que armazena as informações de cada benefício por nível do cliente';

COMMENT ON COLUMN t_sgv_nivel_beneficio.cod_nivel IS
    'Código que representa o nível de cada cliente na regra de benefícios';

COMMENT ON COLUMN t_sgv_nivel_beneficio.desconto IS
    'Porcentagem de desconto de acordo com o nível do cliente';

COMMENT ON COLUMN t_sgv_nivel_beneficio.classificacao_estrela_cliente IS
    'Atributo que armazena a classificação do cliente';

ALTER TABLE t_sgv_nivel_beneficio ADD CONSTRAINT ck_t_sgv_nivel_beneficio_1 CHECK ( classificacao_estrela_cliente <= 5 );

ALTER TABLE t_sgv_nivel_beneficio ADD CONSTRAINT pk_t_sgv_nivel_beneficio PRIMARY KEY ( cod_nivel );

CREATE TABLE t_sgv_pessoa_fisica (
    cod_cliente       NUMBER(5) NOT NULL,
    cpf_cliente       NUMBER(11) NOT NULL,
    dat_nascimento    DATE NOT NULL,
    sexo_biológico    CHAR(1) NOT NULL,
    genero_nascimento VARCHAR2(30),
    tipo_cliente      CHAR(1) NOT NULL
);

COMMENT ON TABLE t_sgv_pessoa_fisica IS
    'Entidade especializada que armazena as informações sobre cada cliente pessoa física';

COMMENT ON COLUMN t_sgv_pessoa_fisica.cod_cliente IS
    'Atributo identificador estrangeiro da entidade pessoa física';

COMMENT ON COLUMN t_sgv_pessoa_fisica.cpf_cliente IS
    'Atributo que armazena o CPF do cliente pessoa física';

COMMENT ON COLUMN t_sgv_pessoa_fisica.dat_nascimento IS
    'Atributo que armazena a data de nascimento do cliente pessoa física';

COMMENT ON COLUMN t_sgv_pessoa_fisica.sexo_biológico IS
    'Atributo que armazena o sexo biológico do cliente pessoa física';

COMMENT ON COLUMN t_sgv_pessoa_fisica.genero_nascimento IS
    'Atributo que armazena o genero de nascimento do cliente pessoa física';

COMMENT ON COLUMN t_sgv_pessoa_fisica.tipo_cliente IS
    'Coluna discriminadora';

ALTER TABLE t_sgv_pessoa_fisica ADD CONSTRAINT un_t_sgv_pessoa_fisica_1 UNIQUE ( cpf_cliente );

CREATE TABLE t_sgv_pessoa_juridica (
    cod_cliente       NUMBER(5) NOT NULL,
    num_cnpj          NUMBER(14) NOT NULL,
    dat_fundacao      DATE NOT NULL,
    num_insc_estadual NUMBER(9),
    tipo_cliente      CHAR(1) NOT NULL
);

COMMENT ON TABLE t_sgv_pessoa_juridica IS
    'Entidade especializada que armazena as informações sobre cada cliente pessoa jurídica';

COMMENT ON COLUMN t_sgv_pessoa_juridica.cod_cliente IS
    'Atributo identificador estrangeiro da entidade pessoa jurídica';

COMMENT ON COLUMN t_sgv_pessoa_juridica.num_cnpj IS
    'Atributo que armazena o numero do CNPJ  do cliente pessoa juridica';

COMMENT ON COLUMN t_sgv_pessoa_juridica.dat_fundacao IS
    'Atributo que armazena a data de fundação do cliente pessoa juridica';

COMMENT ON COLUMN t_sgv_pessoa_juridica.num_insc_estadual IS
    'Atributo que armazena o numero da inscrição estadual  do cliente pessoa juridica';

COMMENT ON COLUMN t_sgv_pessoa_juridica.tipo_cliente IS
    'Coluna discriminadora';

ALTER TABLE t_sgv_pessoa_juridica ADD CONSTRAINT un_t_sgv_pessoa_juridica_1 UNIQUE ( num_cnpj );

CREATE TABLE t_sgv_produto (
    cod_produto          NUMBER(5) NOT NULL,
    cod_categoria        NUMBER(5) NOT NULL,
    des_produto          VARCHAR2(50) NOT NULL,
    des_completa_produto VARCHAR2(100) NOT NULL,
    preço_unitario       NUMBER(4, 2) NOT NULL,
    status               VARCHAR2(30) NOT NULL,
    cod_barras           NUMBER(13)
);

COMMENT ON TABLE t_sgv_produto IS
    'Entidade que armazena os dados do produto';

COMMENT ON COLUMN t_sgv_produto.cod_produto IS
    'Atributo identificador da entidade produto';

COMMENT ON COLUMN t_sgv_produto.cod_categoria IS
    'Atributo estrangeiro que armazena a categoria do produto';

COMMENT ON COLUMN t_sgv_produto.des_produto IS
    'Atributo que armazena a descrição do produto';

COMMENT ON COLUMN t_sgv_produto.des_completa_produto IS
    'Atributo que armazena a descrição completa do produto';

COMMENT ON COLUMN t_sgv_produto.preço_unitario IS
    'Atributo que armazena o preço unitário do produto';

COMMENT ON COLUMN t_sgv_produto.status IS
    'Atributo que armazena o status do produto';

COMMENT ON COLUMN t_sgv_produto.cod_barras IS
    'Atributo que armazena o código de barras do produto, conforme padrão EAN-13';

ALTER TABLE t_sgv_produto ADD CONSTRAINT pk_t_sgv_produto PRIMARY KEY ( cod_produto );

ALTER TABLE t_sgv_produto ADD CONSTRAINT un_t_sgv_produto UNIQUE ( des_produto );

CREATE TABLE t_sgv_status_chamado (
    cod_status_chamado   NUMBER(2) NOT NULL,
    des_status_chamado   VARCHAR2(70) NOT NULL,
    sigla_status_chamado CHAR(1) NOT NULL
);

COMMENT ON TABLE t_sgv_status_chamado IS
    'Entidade que armazena os status dos chamados';

COMMENT ON COLUMN t_sgv_status_chamado.cod_status_chamado IS
    'Atributo identificador da entidade status do chamado';

COMMENT ON COLUMN t_sgv_status_chamado.des_status_chamado IS
    'Atributo que armazena a descrição do status do chamado';

COMMENT ON COLUMN t_sgv_status_chamado.sigla_status_chamado IS
    'Atributo que armazena a sigla do status do chamado';

ALTER TABLE t_sgv_status_chamado
    ADD CONSTRAINT ck_t_sgv_status_chamado CHECK ( sigla_status_chamado = 'A'
                                                   OR sigla_status_chamado = 'E'
                                                   OR sigla_status_chamado = 'C'
                                                   OR sigla_status_chamado = 'F'
                                                   OR sigla_status_chamado = 'X' );

ALTER TABLE t_sgv_status_chamado
    ADD CONSTRAINT ck_t_sgv_des_chamado CHECK ( des_status_chamado = 'Aberto'
                                                OR des_status_chamado = 'Em atendimento'
                                                OR des_status_chamado = 'Cancelado'
                                                OR des_status_chamado = 'Fechado com sucesso'
                                                OR des_status_chamado = 'Fechado com insatisfação do cliente' );

ALTER TABLE t_sgv_status_chamado ADD CONSTRAINT pk_t_sgv_status_chamado PRIMARY KEY ( cod_status_chamado );

CREATE TABLE t_sgv_tipo_video (
    cod_tipo_video NUMBER(5) NOT NULL,
    des_tipo_video VARCHAR2(50) NOT NULL
);

COMMENT ON TABLE t_sgv_tipo_video IS
    'Entidade que armazena os tipos de vídeos dos produtos';

COMMENT ON COLUMN t_sgv_tipo_video.cod_tipo_video IS
    'Atributo identificador da entidade tipo de vídeo do produto';

COMMENT ON COLUMN t_sgv_tipo_video.des_tipo_video IS
    'Atributo que armazena a descrição do tipo de vídeo do produto';

ALTER TABLE t_sgv_tipo_video ADD CONSTRAINT pk_t_sgv_tipo_video PRIMARY KEY ( cod_tipo_video );

CREATE TABLE t_sgv_video_produto (
    cod_video          NUMBER(5) NOT NULL,
    cod_produto        NUMBER(5) NOT NULL,
    cod_tipo_video     NUMBER(5) NOT NULL,
    status             CHAR(1) NOT NULL,
    dat_cadastro_video DATE NOT NULL,
    arq_video          BLOB NOT NULL
);

COMMENT ON TABLE t_sgv_video_produto IS
    'Entidade que armazena os dados dos videos dos produtos';

COMMENT ON COLUMN t_sgv_video_produto.cod_video IS
    'Atributo identificador da entidade video do produto';

COMMENT ON COLUMN t_sgv_video_produto.cod_produto IS
    'Atributo estrangeiro que armazena o código do video';

COMMENT ON COLUMN t_sgv_video_produto.cod_tipo_video IS
    'Atributo estrangeiro que armazena o código do tipo do vídeo';

COMMENT ON COLUMN t_sgv_video_produto.status IS
    'Atributo que armazena o status do vídeo do produto';

COMMENT ON COLUMN t_sgv_video_produto.dat_cadastro_video IS
    'Atributo que armazena a data de cadastro do vídeo';

ALTER TABLE t_sgv_video_produto
    ADD CONSTRAINT ck_t_sgv_video_produto_status CHECK ( status = 'A'
                                                         OR status = 'I' );

ALTER TABLE t_sgv_video_produto ADD CONSTRAINT pk_t_sgv_video_produto PRIMARY KEY ( cod_video );

CREATE TABLE t_sgv_visualização_video (
    cod_vis_video NUMBER(10) NOT NULL,
    cod_video     NUMBER(5) NOT NULL,
    cod_acesso    NUMBER(10) NOT NULL,
    dat_visita    TIMESTAMP NOT NULL
);

COMMENT ON TABLE t_sgv_visualização_video IS
    'Entidade que armazena as visualizações dos vídeos';

COMMENT ON COLUMN t_sgv_visualização_video.cod_vis_video IS
    'Atributo identificador da entidade visualização do vídeo';

COMMENT ON COLUMN t_sgv_visualização_video.cod_video IS
    'Atributo identificador estrangeiro que armazena o código do vídeo';

COMMENT ON COLUMN t_sgv_visualização_video.cod_acesso IS
    'Atributo estrangeiro que armazena o código do acesso do cliente';

COMMENT ON COLUMN t_sgv_visualização_video.dat_visita IS
    'Atributo que armazena a data da visualização do vídeo';

ALTER TABLE t_sgv_visualização_video ADD CONSTRAINT pk_t_sgv_visualização_video PRIMARY KEY ( cod_vis_video,
                                                                                              cod_video );

ALTER TABLE t_sgv_chamado
    ADD CONSTRAINT fk_t_sgv_chamado FOREIGN KEY ( cod_acesso )
        REFERENCES t_sgv_inf_acesso ( cod_acesso );

ALTER TABLE t_sgv_chamado
    ADD CONSTRAINT fk_t_sgv_chamadov1 FOREIGN KEY ( cod_funcionario )
        REFERENCES t_sgv_funcionario ( cod_funcionario );

ALTER TABLE t_sgv_chamado
    ADD CONSTRAINT fk_t_sgv_chamadov3 FOREIGN KEY ( cod_status_chamado )
        REFERENCES t_sgv_status_chamado ( cod_status_chamado );

ALTER TABLE t_sgv_chamado
    ADD CONSTRAINT fk_t_sgv_chamadov4 FOREIGN KEY ( cod_produto )
        REFERENCES t_sgv_produto ( cod_produto );

ALTER TABLE t_sgv_cidade
    ADD CONSTRAINT fk_t_sgv_cidade FOREIGN KEY ( cod_estado )
        REFERENCES t_sgv_estado ( cod_estado );

ALTER TABLE t_sgv_cliente
    ADD CONSTRAINT fk_t_sgv_cliente FOREIGN KEY ( cod_cidade,
                                                  cod_estado )
        REFERENCES t_sgv_cidade ( cod_cidade,
                                  cod_estado );

ALTER TABLE t_sgv_cliente
    ADD CONSTRAINT fk_t_sgv_clientev1 FOREIGN KEY ( cod_nivel )
        REFERENCES t_sgv_nivel_beneficio ( cod_nivel );

ALTER TABLE t_sgv_funcionario
    ADD CONSTRAINT fk_t_sgv_funcionario FOREIGN KEY ( cod_departamento )
        REFERENCES t_sgv_departamento ( cod_departamento );

ALTER TABLE t_sgv_inf_acesso
    ADD CONSTRAINT fk_t_sgv_inf_acesso FOREIGN KEY ( cod_cliente )
        REFERENCES t_sgv_cliente ( cod_cliente );

ALTER TABLE t_sgv_pessoa_fisica
    ADD CONSTRAINT fk_t_sgv_pessoa_fisica FOREIGN KEY ( cod_cliente )
        REFERENCES t_sgv_cliente ( cod_cliente );

ALTER TABLE t_sgv_pessoa_juridica
    ADD CONSTRAINT fk_t_sgv_pessoa_juridica FOREIGN KEY ( cod_cliente )
        REFERENCES t_sgv_cliente ( cod_cliente );

ALTER TABLE t_sgv_produto
    ADD CONSTRAINT fk_t_sgv_produto FOREIGN KEY ( cod_categoria )
        REFERENCES t_sgv_categoria_produto ( cod_categoria );

ALTER TABLE t_sgv_video_produto
    ADD CONSTRAINT fk_t_sgv_video_produto FOREIGN KEY ( cod_produto )
        REFERENCES t_sgv_produto ( cod_produto );

ALTER TABLE t_sgv_video_produto
    ADD CONSTRAINT fk_t_sgv_video_produtov1 FOREIGN KEY ( cod_tipo_video )
        REFERENCES t_sgv_tipo_video ( cod_tipo_video );

ALTER TABLE t_sgv_visualização_video
    ADD CONSTRAINT fk_t_sgv_visualização_video FOREIGN KEY ( cod_acesso )
        REFERENCES t_sgv_inf_acesso ( cod_acesso );

ALTER TABLE t_sgv_visualização_video
    ADD CONSTRAINT fk_t_sgv_visualização_videov1 FOREIGN KEY ( cod_video )
        REFERENCES t_sgv_video_produto ( cod_video );

CREATE OR REPLACE TRIGGER arc_arc__t_sgv_pessoa_juridica BEFORE
    INSERT OR UPDATE OF cod_cliente ON t_sgv_pessoa_juridica
    FOR EACH ROW
DECLARE
    d CHAR(1);
BEGIN
    SELECT
        a.tipo_cliente
    INTO d
    FROM
        t_sgv_cliente a
    WHERE
        a.cod_cliente = :new.cod_cliente;

    IF ( d IS NULL OR d <> 'J' ) THEN
        raise_application_error(-20223, 'FK FK_T_SGV_PESSOA_JURIDICA in Table T_SGV_PESSOA_JURIDICA violates Arc constraint on Table T_SGV_CLIENTE - discriminator column tipo_cliente doesn''t have value ''J'''
        );
    END IF;

EXCEPTION
    WHEN no_data_found THEN
        NULL;
    WHEN OTHERS THEN
        RAISE;
END;
/

CREATE OR REPLACE TRIGGER arc_arc_3_t_sgv_pessoa_fisica BEFORE
    INSERT OR UPDATE OF cod_cliente ON t_sgv_pessoa_fisica
    FOR EACH ROW
DECLARE
    d CHAR(1);
BEGIN
    SELECT
        a.tipo_cliente
    INTO d
    FROM
        t_sgv_cliente a
    WHERE
        a.cod_cliente = :new.cod_cliente;

    IF ( d IS NULL OR d <> 'F' ) THEN
        raise_application_error(-20223, 'FK FK_T_SGV_PESSOA_FISICA in Table T_SGV_PESSOA_FISICA violates Arc constraint on Table T_SGV_CLIENTE - discriminator column tipo_cliente doesn''t have value ''F'''
        );
    END IF;

EXCEPTION
    WHEN no_data_found THEN
        NULL;
    WHEN OTHERS THEN
        RAISE;
END;
/

CREATE SEQUENCE t_sgv_categoria_produto_cod_ca START WITH 1 MINVALUE 1 MAXVALUE 99999 NOCACHE ORDER;

--DROP SEQUENCE t_sgv_categoria_produto_cod_ca;

CREATE OR REPLACE TRIGGER t_sgv_categoria_produto_cod_ca BEFORE
    INSERT ON t_sgv_categoria_produto
    FOR EACH ROW
BEGIN
    :new.cod_categoria := t_sgv_categoria_produto_cod_ca.nextval;
END;
/

CREATE SEQUENCE t_sgv_chamado_cod_chamado_seq START WITH 1 MINVALUE 1 MAXVALUE 9999999999 NOCACHE ORDER;

--DROP SEQUENCE t_sgv_chamado_cod_chamado_seq;

CREATE OR REPLACE TRIGGER t_sgv_chamado_cod_chamado_trg BEFORE
    INSERT ON t_sgv_chamado
    FOR EACH ROW
BEGIN
    :new.cod_chamado := t_sgv_chamado_cod_chamado_seq.nextval;
END;
/

CREATE SEQUENCE t_sgv_produto_cod_produto_seq START WITH 1 MINVALUE 1 MAXVALUE 99999 NOCACHE ORDER;

--DROP SEQUENCE t_sgv_produto_cod_produto_seq;

CREATE OR REPLACE TRIGGER t_sgv_produto_cod_produto_trg BEFORE
    INSERT ON t_sgv_produto
    FOR EACH ROW
BEGIN
    :new.cod_produto := t_sgv_produto_cod_produto_seq.nextval;
END;
/



-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            16
-- CREATE INDEX                             0
-- ALTER TABLE                             43
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           5
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          3
-- CREATE MATERIALIZED VIEW                 0
-- CREATE MATERIALIZED VIEW LOG             0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
